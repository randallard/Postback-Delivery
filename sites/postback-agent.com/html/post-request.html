<html>
<head>
<title>Postback Agent Test</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>

var postData;
var postTo = 'i';
$(document).ready(function(){
	setPostData();
	$('#switchMethod').click(function(){
               	$('#formMethod').text( $('#formMethod').text() == 'POST' ? 'GET' : 'POST' );
		setPostData();
        });
	$('#ingest').click(function(){
		postTo = 'ingest.php';
		postAJAX();	
	});
	$('#justI').click(function(){
		postTo = 'i';
		postAJAX();	
	});
});
function setPostData() {
	postData = {
          endpoint:{
            method: $('#formMethod').text(),
            url:"http://receiver-one.com/data?key={key}&value={value}&foo={bar}"
          },
          data:[
            {
              key:"Azureus",
              value:"Dendrobates"
            },
            {
              key:"Phyllobates",
              value:"Terribilis"
            }
          ]
        };
}
function postAJAX(){
	var dateNow = new Date();
        $("#divResponse").prepend("<p>Posted Data to /" + postTo + " :" + JSON.stringify(postData) + "<br />Sent at: ["+dateNow.toLocaleString()+"]</p>");
	
	$.ajax({
	    type: 'POST',
	    url: 'http://postback-agent.com/' + postTo,
	    data: JSON.stringify(postData),
	    success: function(result){
			$("#divResponse").prepend("Success:"+result+"<br />");
	},

 

    // Code to run if the request fails; the raw request and

    // status codes are passed to the function

    error: function( xhr, status, errorThrown ) {

        $("#divResponse").prepend( "Error: " + errorThrown +"<br />");

        $("#divResponse").prepend( "Status: " + status +"<br />");

        $("#divResponse").prepend( "XHR: " + xhr +"<br />");

    },

 

    // Code to run regardless of success or failure

    complete: function( xhr, status ) {

        $("#divResponse").prepend( "The request is complete!<br />" );

    }

	
	});
}
</script>
</head>
<body>
Method:<span id='formMethod'>POST</span> <button id='switchMethod'>Switch Method</button><br / -->
<button id='justI'>Post to /i</button>
<button id='ingest'>Post to /ingest.php</button>
<h2>Response:</h2>
<div id="divResponse"></div>

</body>
</html>

